---
title: "Covid91 vaccine study Final2024"
author: "Put your name here!"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="finalSumr2024.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

## Males

$H_0$: The Covid921 vaccine is not effective in MALES  

$H_A$: The Covid921 vaccine is effective in MALES 

### Methods 

Treatment is a categorical variable  
MALES is also a categorical variable  
So we use the cat~cat helper file  

### Descriptive Results 

### Graphical Results

```{r}
males=filter(FinalData,FinalData$sex=="M")
barchartGC(~treatment + infected,data=males)
barchartGC(~infected + treatment,data=males, type="percent")
```

The bar charts indicate that MALES who received the vaccine were less likely to contract Covid921 compared to those who received a placebo. However, about 50% of MALES who received either the vaccine or placebo did not contract the virus.

### Numerical Results

```{r}
table1 <- xtabs(~treatment + infected,data=males)
rowPerc(table1)
colPerc(table1)
```


The numerical results show that about 74% of MALES who received the placebo contracted Covid921, whereas only about 26% of MALES who received the vaccine contracted the virus.

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The chi-squared test and Fisher's Exact Test both show a p-value of 0.00000000000000022, which is less than 0.05. Therefore, we reject the null hypothesis, indicating a statistically significant effect of the vaccine. MALES are 2.8 times more likely to contract Covid921 with the placebo compared to the vaccine.

## Females

$H_0$: The Covid921 vaccine is not effective in FEMALES 

$H_A$: The Covid921 vaccine is effective in FEMALES

### Methods 

Treatment is a categorical variable   
FEMALES is a categorical variable   
So we use is cat~cat helper file 

### Descriptive Results 

### Graphical Results

```{r}
females=filter(FinalData,FinalData$sex=="F")
barchartGC(~treatment + infected,data=females)
barchartGC(~infected + treatment,data=females, type="percent")
```

The bar charts shows that FEMALES who received the vaccine were less likely to contract Covid921 compared to those who received the placebo. However, about 50% of FEMALES in both groups remained uninfected.

### Numerical Results

```{r}
table1 <- xtabs(~treatment + infected,data=females)
rowPerc(table1)
colPerc(table1)
```

The numerical results shows that the Covid921 vaccine reduces the odds of contracting the virus by approximately 46.9% and lowers the risk of infection by around 45.5% compared to the placebo.

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The chi-squared test yields a p-value of 0.00000001914, and the Fisher's Exact Test shows a p-value of 0.00000001246, both less than 0.05. Thus, we reject the null hypothesis. The odds ratio indicates that females are 1.86 times more likely to contract Covid921 with the placebo than with the vaccine.

## LGBTQ

$H_0$: The Covid921 vaccine is not effective in LGBTQ Community.

$H_A$: The Covid921 vaccine is effective in LGBTQ Community.

### Methods 

Treatment is a categorical variable   
LGBTQ is a categorical variable   
So we use is cat~cat helper file    

### Descriptive Results 

### Graphical Results

```{r}
LGBTQ = filter(FinalData, LGBTQ=="gay")

barchartGC(~infected + treatment,data=LGBTQ)
barchartGC(~infected + treatment,data=LGBTQ, type="percent")
```

The barchart shows that LGBTQ who got the vaccines were less likely to get Covid921, than those who got the placebo. However, about 50% of LGBTQ that got the vaccine were OK, and about 45% of LGBTQ with the placebo were OK.

### Numerical Results

```{r}
table1 <- xtabs(~treatment + infected, data=LGBTQ)
rowPerc(table1)
colPerc(table1)
```

The numerical results show that 80% of LGBTQ participants received a placebo and 20% received the Covid921 vaccine. The Covid921 vaccine reduced the odds of contracting the virus to approximately 24% compared to the placebo. The risk of infection with the vaccine was about 44.8% of the risk with the placebo, resulting in a relative risk reduction of around 55.2%, indicating a significant protective effect.

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The chi-squared test shows that the p-value = 0.000002266 which is smaller than 0.05. This shows that the vaccine does significantly reduce the risk of contracting Covid921 among the LGBTQ community, so we reject the null hypothesis.

The Fisher's Exact Test p-value = 0.0000007269, and the odds of getting Covid921 with the vaccine is about 0.24 times the odds of getting it with the placebo. Suggesting that the vaccine considerably lowers the risk compared to the placebo.

## Druggies

$H_0$: The Covid921 vaccine is not effective in Drug users 

$H_A$: The Covid921 vaccine is effective in Drug users

### Methods 

Treatment is a categorical variable   
DRUGGIES is a categorical variable   
So we use is cat~cat helper file    

### Descriptive Results 

### Graphical Results

```{r}
DrugUser=filter(FinalData,FinalData$DrugUser=="yes")

barchartGC(~treatment + infected,data=DrugUser)
barchartGC(~infected + treatment,data=DrugUser,type="percent")
```

The barchart shows that the Drug Users that got the placebo were less likely to get Covid921 then those who got the vaccine. However, both were about 50% OK.

### Numerical Results

```{r}
table1 <- xtabs(~treatment + infected, data=DrugUser)
rowPerc(table1)
colPerc(table1)
```

The numerical results show a 3.28% difference in Covid921 infection rates. Specifically, 3.61% of those who received the vaccine contracted Covid921, compared to 0.33% of those who received the placebo. For those who remained uninfected (OK), there was a 2.61% difference. This analysis presents an unusual result, where the vaccine appears to increase the risk of infection compared to the placebo, which is unexpected. This outcome may suggest either an anomaly in the data or a specific context of the study that warrants further review. Typically, a vaccine is expected to reduce the risk of Covid921, not increase it.

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The chi-squared tests p-value = 0.0000000001414 which is smaller than 0.05, so we reject the null hypothesis. This data shows that there is a significant difference in the incidence of Covid921 between the placebo and vaccine groups. This suggests that the vaccine does have an effect on preventing Covid921.

The Fisher's Exact Tests p-value = 0.000000000003261 which is less than 0.05. This data further confirms the significant difference between the rates of Covid921.

# Overall Results and Conclusions


